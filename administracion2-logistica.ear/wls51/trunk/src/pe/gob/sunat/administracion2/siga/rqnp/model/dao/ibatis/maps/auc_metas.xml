<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<!-- INICIO:DPORRASC LECETURA DE METAS PARA PRESUPUESTO -->
<sqlMap namespace="aucmetas">
	<typeAlias alias="aucMetasBean"
		type="pe.gob.sunat.administracion2.siga.rqnp.model.domain.AucMetasBean" />

 <resultMap id="lstRqnpMetasAUC" class="aucMetasBean">
		<result property="uuooBeneficiaria" column="UUOO_BENEFICIARIA" />
		<result property="actProyecto" 		column="ACTIVIDAD_PROYECTO" />
		<result property="producto" 		column="PRODUCTO" />
		<result property="accion" 			column="ACCION" />
		<result property="cantidad" 		column="CANTIDAD" />
		<result property="precioUnitario" 	column="PRECIO_UNITARIO" />
		<result property="importe" 			column="IMPORTE" />
</resultMap>
	
<select id="selectMetasAuc" parameterClass="java.util.HashMap" resultMap="lstRqnpMetasAUC">
	SELECT
		TDEPENDENCIAS.UNIDAD_ORGANIZACIONAL||' '||TDEPENDENCIAS.DESC_DEPE_TDE AS UUOO_BENEFICIARIA,
		PROYECTOS.CODI_PROY_PRY||' '||PROYECTOS.DESC_PROY_PRY AS ACTIVIDAD_PROYECTO,
		PRODUCTOS.CODI_PROY_PRY||'.'||PRODUCTOS.CODI_PROD_PRD||' '||PRODUCTOS.DESC_PROD_PRD AS PRODUCTO,
		METAS_PRODUCTOS.CODI_PROY_PRY||'.'||METAS_PRODUCTOS.CODI_PROD_PRD||'.'||METAS_PRODUCTOS.CODI_META_MET||' '||METAS_PRODUCTOS.DESC_LARG_MET AS ACCION,
		REQUERIMIENTO_NO_PROG_METAS.CANT_TOTA_DSR AS CANTIDAD,
		REQUERIMIENTO_NO_PROG_BIENES.PUNI_NACI_DSR AS PRECIO_UNITARIO,
		REQUERIMIENTO_NO_PROG_METAS.MONT_NACI_DSR AS IMPORTE
	FROM
		REQUERIMIENTO_NO_PROG_METAS,
		METAS,
		TDEPENDENCIAS,
		PROYECTOS,
		PRODUCTOS,
		METAS_PRODUCTOS,
		REQUERIMIENTO_NO_PROG_BIENES
	WHERE
		REQUERIMIENTO_NO_PROG_METAS.ANNO_EJEC_EJE 		= METAS.ANNO_EJEC_EJE
		AND REQUERIMIENTO_NO_PROG_METAS.SECU_FUNC_SFU 	= METAS.SECU_FUNC_SFU
		AND TDEPENDENCIAS.CODI_DEPE_TDE 				= METAS.CODI_DEPE_TDE
		AND PROYECTOS.CODI_PROY_PRY 					= METAS.CODI_PROY_PRY
		AND PRODUCTOS.CODI_PROY_PRY 					= METAS.CODI_PROY_PRY
		AND PRODUCTOS.CODI_PROD_PRD 					= METAS.CODI_PROD_PRD
		AND METAS_PRODUCTOS.CODI_PROY_PRY 				= METAS.CODI_PROY_PRY
		AND METAS_PRODUCTOS.CODI_PROD_PRD 				= METAS.CODI_PROD_PRD
		AND METAS_PRODUCTOS.CODI_META_MET 				= METAS.CODI_META_MET
		AND REQUERIMIENTO_NO_PROG_METAS.CODI_RQNP_SRM 	= REQUERIMIENTO_NO_PROG_BIENES.CODI_RQNP_SRM 
		AND REQUERIMIENTO_NO_PROG_METAS.CODI_BSER_CAT 	= REQUERIMIENTO_NO_PROG_BIENES.CODI_BSER_CAT
		AND REQUERIMIENTO_NO_PROG_METAS.CODI_RQNP_SRM 	= #cod_req#
		
		AND REQUERIMIENTO_NO_PROG_BIENES.CODI_BSER_CAT	= #cod_bien#
  </select> 
<!-- FIN: DPORRASC METAS -->

</sqlMap>